## Basic setup

### Step 1. Download PayumBundle

Ultimately, the PayumBundle files should be downloaded to the `vendor/payum` directory.

This can be done in several ways, depending on your preference. The method described here is the standard method for Symfony 2.1, using [composer](http://getcomposer.org/).
If you prefer use git submodule [read this tutorial](install_as_git_submodules.md) and resume to step 2.

Add the following lines in your `composer.json` file:

```json
{
    "require": {
        "payum/payum-bundle": "dev-master"
    }
}
```

_**Note:** You may want to adapt this line to use a specific version._

Now, run composer.phar to download the bundle:

```bash
$ php composer.phar install
```

_**Note:** You can immediately start using it. The autoloading files have been generated by composer and already included to the app autoload file._

### Step 2: Enable the bundle

Finally, enable the bundle in the kernel:

``` php
<?php
// app/AppKernel.php

public function registerBundles()
{
    $bundles = array(
        // ...
        new Payum\Bundle\PayumBundle\PayumBundle(),
    );
}
```

### Step 3: Configure capture controller (Optional).

_**Note:** Skipp this step if you do not want to use `CaptureController` distributed with the bundle._

#### 3-a. Add routing

First you have to add routing:

In YAML:

``` yaml
# app/config/routing.yml
payum_capture:
    resource: "@PayumBundle/Resources/config/routing/capture.xml"
```

Or if you prefer XML:

``` xml
<!-- app/config/routing.xml -->
<import resource="@PayumBundle/Resources/config/routing/capture.xml"/>
```

#### 3-b. Configure security token (Doctrine ORM).

First you have to extend `Token` entity:

```php
<?php
namespace Acme\PaymentBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

use Payum\Bridge\Doctrine\Entity\Token;

/**
 * @ORM\Table(name="payum_security_token")
 * @ORM\Entity
 */
class PayumSecurityToken extends Token
{
}
```

next, you have to add mapping of extended token and configure token storage:

```yml
#app/config/config.yml

doctrine:
    orm:
        entity_managers:
            default:
                mappings:
                    payum:
                        is_bundle: false
                        type: xml
                        dir: %kernel.root_dir%/../vendor/payum/payum/src/Payum/Bridge/Doctrine/Resources/mapping
                        prefix: Payum\Bridge\Doctrine\Entity

payum:
    security:
        token_storage:
            Acme\PaymentBundle\Entity\PayumSecurityToken:
                doctrine:
                    driver: orm
```

#### 3-c. Configure security token (Filesystem).

next, you have to configure token storage:

```php
<?php
namespace Acme\PaymentBundle\Model;

use Payum\Model\Token;

class PayumSecurityToken extends Token
{
}
```

and configure storage to use this model:

```yaml
#app/config/config.yml

payum:
    security:
        token_storage:
            Acme\PaymentBundle\Entity\PayumSecurityToken:
                filesystem:
                    storage_dir: %kernel.root_dir%/Resources/payments
                    id_property: hash
```

### Next Step

Now you are ready to configure desired payment. Proceed to [index](index.md) and choose payment specific document.